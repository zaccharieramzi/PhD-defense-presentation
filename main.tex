% cSpell: disable
%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------
\documentclass[aspectratio=169,xcolor=dvipsnames]{beamer}
\usetheme{SimplePlus}

\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage[titlenumbered,ruled,noend,linesnumbered]{algorithm2e}
\newcommand\mycommfont[1]{\footnotesize\ttfamily\textcolor{blue}{#1}}
\SetCommentSty{mycommfont}
\usepackage{bbm}
\usepackage{mathtools}
\usepackage{xspace}
\usepackage{dsfont}
\usepackage{pifont}
\usepackage{hyperref}
\usepackage{graphicx} % Allows including images
\usepackage{makecell}
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{fontawesome}
\usepackage{multicol}
\usepackage{adjustbox}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{appendixnumberbeamer}
\usepackage[
	backend=biber,
	style=authoryear-comp,
	natbib=true,
	backref=True,
	hyperref=true,
	url=false,
	isbn=false,
	maxcitenames=1,
	maxbibnames=100,
	giveninits=true,
]{biblatex}
\preto\fullcite{\AtNextCite{\defcounter{maxnames}{7}}}
\input{./bold_alphabet}
\input{./abrmath}
\input{./eq_annotate}
\usepackage{tikz}
\usetikzlibrary{tikzmark}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{svg.path}
\usetikzlibrary{calc,fit,shapes}
\usetikzlibrary{arrows,chains}
\usetikzlibrary{overlay-beamer-styles}
\usetikzlibrary{shapes.arrows}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{matrix}


\includeonly{clinical_applic}
%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[Advanced deep neural networks for MRI image reconstruction]{Advanced deep neural networks for MRI image reconstruction from highly undersampled data in challenging acquisition settings
} % The short title appears at the bottom of every slide, the full title is only on the title page
\subtitle{PhD defense, 18th February 2022}

\titlegraphic{
    \begin{tikzpicture}[overlay,remember picture]
        \node[below right=0.2cm and 0.2cm of current page.150] (cea) {\includegraphics[width=4em]{Figures/logos/CEA_logo.jpg}};
        \node[right=of cea] (neurospin) {\includegraphics[width=4em]{Figures/logos/neurospin_logo.jpg}};
        \node[right=of neurospin] (cosmostat) {\includegraphics[width=6em]{Figures/logos/cosmostat_logo.jpg}};
        \node[right=of cosmostat] (inria) {\includegraphics[width=6em]{Figures/logos/inria_logo.jpg}};
        \node[right=of inria] (parietal) {\includegraphics[width=6em]{Figures/logos/parietal_logo.jpg}};
    \end{tikzpicture}
}

\author[Zaccharie] {Zaccharie Ramzi \\  {\footnotesize supervisors: Philippe Ciuciu and Jean-Luc Starck}}
% XXX: add university and ED
\institute[Inria-CEA] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
    Parietal team, Inria Saclay \\
    NeuroSpin and Cosmostat, CEA Saclay
}
\date{18th February 2022} % Date, can be changed to a custom date

\addbibresource{ThesisBib.bib}
\addbibresource{websites.bib}


\setbeamerfont{subsection in toc}{size=\small}
\setbeamerfont{section in toc}{size=\large}
\setbeamertemplate{blocks}[rounded]%
[shadow=true]


% debug
% \makeatletter
% \begingroup
% \edef\get@@version{\def\noexpand\get@version##1\detokenize{TeX Live}##220##3##4##5)##6\noexpand\@nil}
% \get@@version{\gdef\TeXLiveVersion{20#3#4}}
% \expandafter\get@version\pdftexbanner\@nil
% \endgroup
% \makeatother

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------

\newcommand*{\measurements}{\tikzmarknode{kspace}{\highlight{yellow}{$\ybb$}}}
\newcommand*{\imageb}{\tikzmarknode{image}{\highlight{blue}{$\xb$}}}
\newcommand*{\adjointop}{\highlight{green}{$\mathcal{A}^H$}}

\begin{document}

\begin{frame}
    % Print the title page as the first slide
    \titlepage
\end{frame}

% Introduction: the problem at hand
% Introduction: physics of MRI
% Acceleration: classics
% Acceleration: CS
% Deep Learning
% Application of DL to MRI: model agnostic, single domain and unrolled networks
% Clinical applicability
% Going further !
% CCL
{
\usebackgroundtemplate{\includegraphics[width=\paperwidth]{Figures/inside_mri.png}}
\begin{frame}[plain]
    % I would like to have the picture of inside the MRI
    % and pass the sound of an MRI scan
    %  \href{run:sons/extract.mp3}{\beamerbutton{Ã©couter}} (https://texnique.fr/osqa/questions/2988/du-son-dans-beamer)
    % https://www.francetvinfo.fr/sante/malgre-l-augmentation-des-besoins-medicaux-le-deficit-en-france-d-appareils-irm-se-fait-de-plus-en-plus-sentir_220301.html
    \href{run:Sounds/mri_sounds.mp3}{\faPlayCircle}
    \begin{minipage}[t][.8\textheight]{\textwidth}
        \vfill

        \tiny
        Credits: \href{https://www.francetvinfo.fr/sante/malgre-l-augmentation-des-besoins-medicaux-le-deficit-en-france-d-appareils-irm-se-fait-de-plus-en-plus-sentir_220301.html}{Getty Images / rubberball}
      \end{minipage}
\end{frame}
}

% link between the 2: this is the sound you hear when undergoing an MRI
% now imagine that you will on average hear this during x minutes
% MRI scanners being slow not only generate discomfort but have other impacts on their efficiency...
\begin{frame}{MRI is slow}
    % for debug
    % This has been run with \TeX~Live~\TeXLiveVersion.
    \begin{multicols}{2}
        MRI~(Magnetic Resonance Imaging) scan duration: 15 min (up to 90 min).\footfullcite{nhs}
    \begin{itemize}
        \item discomfort \& accessibility issues
        \item reduced patient throughput
        \item increased chance of motion as time progresses
    \end{itemize}
    \newpage
    \begin{figure}
        \centering
        \includegraphics[height=0.5\textheight]{Figures/intro_figures/motion_mri.png}
        \caption{Example of motion artifacts in MRI\footfullcite{grimm2015reconstruction}}
    \end{figure}
    \end{multicols}
    % give typical duration (compare to CT)
    % give associated problems

\end{frame}

\begin{frame}{Our objective: accelerate MRI scans}
    % give TOC
    % \setlength{\parskip}{1ex}
    % \begin{multicols}{2}
    % \tableofcontents
    % \end{multicols}
%     \begin{center}
%         \begin{tikzpicture}[ampersand replacement=\&]
%             \matrix [matrix of nodes,column sep=.5cm,row sep=.5cm,every node/.style=draw]
% {
%  |(ub)| Unrolled Benchmark \& |(x)|  XPDNet \& |(nc)| NC-PDNet \\
%  |(sh)| SHINE \& |(le)|  Learnlets \& |(uq)| Uncertainty Quantification\\
% };
%         \node[] {};
%         \end{tikzpicture}
%     \end{center}
    \begin{enumerate}
        \item Study and extension of the state-of-the-art: unrolled models.
        \item Tools to tackle deep learning blind spots: generalization and uncertainty quantification.
        \item Methods to build even deeper models.
    \end{enumerate}

\end{frame}


\include{intro_mri}
\include{intro_cs}

\addtocontents{toc}{\newpage}

% \include{deep_learning}
\include{unrolled_mri}
\include{very_deep}
\include{clinical_applic}


\section{Conclusions \& Future works}

\begin{frame}{Conclusions}
    % what have we seen so far in the journey?
    % \begin{enumerate}[<+->]
    %     \item MRI is an important medical imaging modality, but it is inherently slow due to the Nuclear Magnetic Resonance phenomenon it relies on.
    %     \item Using redundancy is our main tool to accelerate MRI scans, but exploiting redundancy is not always straightforward.
    %     \item Deep Learning can allow us to express structure in a more principled way, and we saw two examples of this.
    %     \begin{enumerate}[<+->]
    %         \item The \highlight{green}{XPDNet}, a deep learning network that secured the 2nd spot of the 2020 fastMRI challenge.
    %         \item The \highlight{green}{NC-PDNet}, a deep learning network that can reconstruct single-coil 3D non-Cartesian data.
    %     \end{enumerate}
    %     \item In order to prepare for even deeper networks, with the promise of even better results, we proposed \highlight{green}{SHINE}, a method to accelerate DEQs, which are memory-efficient models.
    % \end{enumerate}
    \begin{enumerate}[<+->]
        \item In order to accelerate MRI, I show how to further adapt unrolled models to MRI reconstruction:
        \begin{enumerate}
            \item 2D multi-coil: \highlight{green}{XPDNet}
            \item non-Cartesian: \highlight{green}{NC-PDNet}
        \end{enumerate}
        \item I also tackled 3 challenges associated with the application of deep learning to MRI reconstruction:
        \begin{enumerate}
            \item generalization: \highlight{green}{Learnlets}
            \item uncertainty quantification: \highlight{green}{Denoising Score Matching}
            \item training memory and speed: \highlight{green}{SHINE}
        \end{enumerate}
    \end{enumerate}
\end{frame}

\begin{frame}{Future works}
    % DEQs for MRI recon
    % More operator correction
    % Trajectory learning
    \begin{itemize}
        \item Applying DEQs to MRI reconstruction.
        \item Refine the measurement operator even more, for example with $\Bb_0$ inhomogeneity corrections.
        \item Learn better k-space acquisition trajectories.
        \item Extend the NC-PDNet to more dimensions, like in fMRI.
        \item Understand better how far the subnetworks learn something far from the score of the prior distribution.
    \end{itemize}
\end{frame}

\begin{frame}{Additional contribution}
    \begin{exampleblock}{Contribution}
        \begin{itemize}
            \item \fullcite{Farrens2020}
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Miscellanous contributions}
    \begin{exampleblock}{Contributions}
        \begin{itemize}
            \item Jean Zay user doc: \href{https://jean-zay-doc.readthedocs.io/}{jean-zay-doc.readthedocs.io}
            \item NeuroSpin Deep Learning lecture group
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Thank you all!}
    \begin{center}
        \includegraphics[height=0.5\textheight]{Figures/parietal_2019.png}
        \includegraphics[width=0.5\textwidth]{Figures/cosmostat_zoom.jpeg}
    \end{center}
\end{frame}
%----------------------------------------------------------------------------------------

\include{add_slides}

\begin{frame}[allowframebreaks]{References}
    \printbibliography
\end{frame}

\end{document}
